<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Global Passive Analysis: 2026 Edition</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.2/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=DM+Mono:wght@400;500&family=DM+Sans:wght@400;500;700;800&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg-a: #dde8f5; --bg-b: #eef4fb; --bg-c: #e8f5ee;
      --orb1: rgba(99,102,241,0.18); --orb2: rgba(16,185,129,0.14); --orb3: rgba(59,130,246,0.12);
      --glass-bg: rgba(255,255,255,0.55);
      --glass-border: rgba(255,255,255,0.78);
      --glass-shadow: 0 8px 32px rgba(0,0,0,0.08), 0 1px 2px rgba(0,0,0,0.04);
      --glass-hover: 0 12px 40px rgba(59,130,246,0.15), 0 2px 8px rgba(0,0,0,0.06);
      --text-1: #0f172a; --text-2: #475569; --text-3: #94a3b8;
      --divider: rgba(0,0,0,0.07);
      --track: rgba(0,0,0,0.1); --track-g: rgba(16,185,129,0.15);
      --badge-bg: rgba(59,130,246,0.1); --badge: #2563eb;
      --score-bg: rgba(0,0,0,0.04); --score-border: rgba(0,0,0,0.06); --score-bar: #64748b;
      --fs-bg: rgba(16,185,129,0.08); --fs-border: rgba(16,185,129,0.2);
      --info-bg: rgba(224,242,254,0.7); --info-border: rgba(186,230,253,0.8); --info-text: #0c4a6e;
      --empty-bg: rgba(0,0,0,0.03); --empty-border: rgba(0,0,0,0.08);
      --grid: rgba(0,0,0,0.05);
      --tt-bg: rgba(255,255,255,0.92); --tt-border: rgba(0,0,0,0.08);
    }

    html.dark {
      --bg-a: #0f0c29; --bg-b: #0d1b2a; --bg-c: #0a1628;
      --orb1: rgba(99,102,241,0.25); --orb2: rgba(16,185,129,0.18); --orb3: rgba(59,130,246,0.2);
      --glass-bg: rgba(255,255,255,0.06);
      --glass-border: rgba(255,255,255,0.11);
      --glass-shadow: 0 8px 32px rgba(0,0,0,0.45), 0 1px 2px rgba(0,0,0,0.2);
      --glass-hover: 0 12px 40px rgba(99,102,241,0.22), 0 2px 8px rgba(0,0,0,0.35);
      --text-1: #f1f5f9; --text-2: #94a3b8; --text-3: #475569;
      --divider: rgba(255,255,255,0.08);
      --track: rgba(255,255,255,0.12); --track-g: rgba(16,185,129,0.2);
      --badge-bg: rgba(59,130,246,0.15); --badge: #93c5fd;
      --score-bg: rgba(255,255,255,0.04); --score-border: rgba(255,255,255,0.07); --score-bar: #94a3b8;
      --fs-bg: rgba(16,185,129,0.1); --fs-border: rgba(16,185,129,0.25);
      --info-bg: rgba(30,58,92,0.5); --info-border: rgba(59,130,246,0.25); --info-text: #bae6fd;
      --empty-bg: rgba(255,255,255,0.03); --empty-border: rgba(255,255,255,0.08);
      --grid: rgba(255,255,255,0.05);
      --tt-bg: rgba(15,23,42,0.93); --tt-border: rgba(255,255,255,0.1);
    }

    body { font-family:'DM Sans',sans-serif; color:var(--text-1); min-height:100vh; transition:color 0.3s; }
    .mono { font-family:'DM Mono',monospace; }

    #bg {
      position:fixed; inset:0; z-index:0;
      background: linear-gradient(135deg, var(--bg-a) 0%, var(--bg-b) 45%, var(--bg-c) 100%);
      transition: background 0.4s;
    }
    #bg::before { content:''; position:absolute; inset:0; background: radial-gradient(circle at 18% 18%, var(--orb1) 0%, transparent 58%); }
    #bg::after  { content:''; position:absolute; inset:0; background: radial-gradient(circle at 82% 72%, var(--orb2) 0%, transparent 55%); }
    #orb3       { position:absolute; inset:0;              background: radial-gradient(circle at 54% 8%,  var(--orb3) 0%, transparent 50%); }

    #root { position:relative; z-index:1; }

    .glass {
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: 18px;
      box-shadow: var(--glass-shadow);
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
      transition: box-shadow 0.25s, border-color 0.25s, background 0.3s;
    }
    .glass-card {
      transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s;
      cursor: default;
    }
    .glass-card:hover {
      transform: scale(1.02);
      box-shadow: var(--glass-hover);
      border-color: rgba(99,102,241,0.3);
    }
    .glass-card.is-hovered {
      transform: scale(1.02);
      box-shadow: var(--glass-hover);
      border-color: rgba(99,102,241,0.35);
    }

    input[type=range] {
      -webkit-appearance:none; appearance:none;
      width:100%; height:6px; border-radius:9999px; outline:none; cursor:pointer;
    }
    input[type=range]::-webkit-slider-thumb {
      -webkit-appearance:none; width:16px; height:16px; border-radius:50%;
      background:#3b82f6; cursor:pointer;
      border:2px solid rgba(255,255,255,0.8);
      box-shadow:0 1px 6px rgba(59,130,246,0.4);
    }

    .theme-btn {
      display:flex; align-items:center; gap:6px;
      padding:6px 14px; border-radius:999px;
      font-size:12px; font-weight:700; font-family:'DM Sans',sans-serif;
      cursor:pointer;
      border:1px solid var(--glass-border);
      background:var(--glass-bg);
      color:var(--text-2);
      backdrop-filter:blur(12px); -webkit-backdrop-filter:blur(12px);
      transition:all 0.2s;
    }
    .theme-btn:hover { background:rgba(99,102,241,0.15); color:var(--text-1); }

    @media (max-width:900px) { .main-grid { grid-template-columns:1fr !important; } }
  </style>
</head>
<body>
<div id="bg"><div id="orb3"></div></div>
<div id="root"></div>

<script type="text/babel">
const { useState, useMemo, useEffect } = React;

const FUND_DATA = [
  { name:'Vanguard FTSE Global All Cap Index', ticker:'VAFT', ocf:0.0023, color:'#e11d48', type:'OEIC', trackingError:[0.05,0.10], coverage:99 },
  { name:'Vanguard FTSE All-World UCITS ETF',  ticker:'VWRP', ocf:0.0022, color:'#f59e0b', type:'ETF',  trackingError:[0.03,0.08], coverage:90 },
  { name:'iShares MSCI ACWI UCITS ETF',        ticker:'SSAC', ocf:0.0020, color:'#10b981', type:'ETF',  trackingError:[0.18,0.25], coverage:85 },
  { name:'SPDR MSCI ACWI IMI UCITS ETF',       ticker:'SPYI', ocf:0.0017, color:'#3b82f6', type:'ETF',  trackingError:[0.15,0.20], coverage:99 },
  { name:'Invesco FTSE All-World UCITS ETF',   ticker:'FWRG', ocf:0.0015, color:'#8b5cf6', type:'ETF',  trackingError:[0.10,0.15], coverage:90 },
  { name:'HSBC FTSE All-World Index',          ticker:'HMWO', ocf:0.0013, color:'#ec4899', type:'OEIC', trackingError:[0.05,0.15], coverage:90 },
  { name:'SPDR MSCI ACWI UCITS ETF',           ticker:'ACWE', ocf:0.0012, color:'#0ea5e9', type:'ETF',  trackingError:[0.10,0.15], coverage:85 },
];

const fmt  = v => new Intl.NumberFormat('en-GB',{style:'currency',currency:'GBP',maximumFractionDigits:0}).format(v);
const fmtK = v => v>=1000000?`Â£${(v/1000000).toFixed(1)}m`:v>=1000?`Â£${(v/1000).toFixed(0)}k`:`Â£${v}`;

const Icon = ({ d, size=14, color='var(--text-3)' }) => (
  <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color}
    strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"
    style={{display:'inline-block',verticalAlign:'middle',flexShrink:0}}>
    {[].concat(d).map((p,i)=><path key={i} d={p}/>)}
  </svg>
);

const I = {
  pound:    "M4 21h16M9 3v9a3 3 0 006 0V3M4 12h8",
  calendar: ["M8 2v4","M16 2v4","M3 10h18","M3 6a2 2 0 012-2h14a2 2 0 012 2v14a2 2 0 01-2 2H5a2 2 0 01-2-2V6z"],
  trend:    "M22 7l-8.5 8.5-5-5L2 17",
  filter:   ["M22 3H2l8 9.46V19l4 2v-8.54L22 3"],
  bar:      ["M3 3v18h18","M7 16v-5","M11 16V8","M15 16v-2","M19 16v-8"],
  globe:    ["M12 22A10 10 0 1012 2a10 10 0 000 20z","M2 12h20","M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"],
  zap:      "M13 2L3 14h9l-1 8 10-12h-9l1-8z",
  target:   ["M12 22A10 10 0 1012 2a10 10 0 000 20z","M12 18A6 6 0 1012 6a6 6 0 000 12z","M12 14A2 2 0 1012 10a2 2 0 000 4z"],
  star:     "M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z",
  check:    ["M22 11.08V12a10 10 0 11-5.93-9.14","M22 4L12 14.01l-3-3"],
  sun:      ["M12 1v2","M12 21v2","M4.22 4.22l1.42 1.42","M18.36 18.36l1.42 1.42","M1 12h2","M21 12h2","M4.22 19.78l1.42-1.42","M18.36 5.64l1.42-1.42","M12 17A5 5 0 1012 7a5 5 0 000 10z"],
  moon:     "M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z",
};

function useCalc(investment, years, g, minScore) {
  return useMemo(() => {
    const gr = g/100;
    const m = FUND_DATA.map(f=>({ocf:f.ocf,coverage:f.coverage,error:(f.trackingError[0]+f.trackingError[1])/2}));
    const rng = {
      ocf:     {min:Math.min(...m.map(x=>x.ocf)),     max:Math.max(...m.map(x=>x.ocf))},
      coverage:{min:Math.min(...m.map(x=>x.coverage)),max:Math.max(...m.map(x=>x.coverage))},
      error:   {min:Math.min(...m.map(x=>x.error)),   max:Math.max(...m.map(x=>x.error))},
    };
    const sc = (v,mn,mx,inv=false)=>{
      if(mx===mn) return 10;
      return Math.round((inv?1+9*(mx-v)/(mx-mn):1+9*(v-mn)/(mx-mn))*10)/10;
    };
    const all = FUND_DATA.map(f=>{
      const e=(f.trackingError[0]+f.trackingError[1])/2;
      const scores={coverage:sc(f.coverage,rng.coverage.min,rng.coverage.max),ocf:sc(f.ocf,rng.ocf.min,rng.ocf.max,true),error:sc(e,rng.error.min,rng.error.max,true)};
      return {...f,scores,totalScore:parseFloat((scores.coverage+scores.ocf+scores.error).toFixed(1))};
    });
    const visible = all.filter(f=>f.totalScore>=minScore);
    const series = visible.map(fund=>{
      const pts=[];
      for(let i=0;i<=years;i++){
        const gross=investment*Math.pow(1+gr,i);
        let bal=investment;
        for(let y=0;y<i;y++) bal=bal*(1+gr)*(1-fund.ocf);
        pts.push(Math.round(gross-bal));
      }
      return {...fund,pts};
    });
    const maxFee=Math.max(1,...series.flatMap(s=>s.pts));
    const results=visible.map(fund=>{
      const gross=Math.round(investment*Math.pow(1+gr,years));
      let bal=investment;
      for(let y=0;y<years;y++) bal=bal*(1+gr)*(1-fund.ocf);
      const totalFees=Math.round(gross-bal);
      return {...fund,finalBalance:Math.round(bal),totalFees,percentageLost:gross>0?((totalFees/gross)*100).toFixed(1):'0'};
    }).sort((a,b)=>a.totalFees-b.totalFees);
    return {series,maxFee,results,visible};
  },[investment,years,g,minScore]);
}

function Chart({series,years,maxFee,hovered,setHovered}) {
  const W=880,H=340,PL=64,PR=16,PT=10,PB=36;
  const cw=W-PL-PR,ch=H-PT-PB;
  const xp=i=>PL+(i/years)*cw;
  const yp=v=>PT+ch-(v/maxFee)*ch;
  const [tip,setTip]=useState(null);

  if(!series.length) return(
    <div style={{height:320,display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',
      background:'var(--empty-bg)',borderRadius:12,border:'2px dashed var(--empty-border)'}}>
      <Icon d={I.filter} size={36}/>
      <p style={{color:'var(--text-2)',fontWeight:500,marginTop:10}}>No funds meet the current filter.</p>
    </div>
  );

  const onMove=e=>{
    const r=e.currentTarget.getBoundingClientRect();
    const svgX=(e.clientX-r.left)*(W/r.width);
    const yr=Math.max(0,Math.min(years,Math.round(((svgX-PL)/cw)*years)));
    setTip({yr,x:xp(yr)});
  };

  return(
    <div>
      <svg viewBox={`0 0 ${W} ${H}`} style={{width:'100%',height:'auto',display:'block',cursor:'crosshair'}}
        onMouseMove={onMove} onMouseLeave={()=>setTip(null)}>
        <defs>
          {series.map(s=>(
            <linearGradient key={s.ticker} id={`g-${s.ticker}`} x1="0" y1="0" x2="0" y2="1">
              <stop offset="0%"   stopColor={s.color} stopOpacity={hovered&&hovered!==s.ticker?0.02:0.2}/>
              <stop offset="100%" stopColor={s.color} stopOpacity={0}/>
            </linearGradient>
          ))}
        </defs>
        {Array.from({length:6},(_,i)=>i).map(i=>{
          const y=PT+(i/5)*ch,v=maxFee*(1-i/5);
          return(<g key={i}>
            <line x1={PL} y1={y} x2={W-PR} y2={y} stroke="var(--grid)" strokeWidth="1"/>
            <text x={PL-6} y={y+4} textAnchor="end" fontSize="10" fill="var(--text-3)" fontFamily="DM Mono,monospace">{fmtK(v)}</text>
          </g>);
        })}
        {Array.from({length:Math.min(years+1,11)},(_,i)=>Math.round(i*years/Math.min(years,10))).map(yr=>(
          <text key={yr} x={xp(yr)} y={H-6} textAnchor="middle" fontSize="10" fill="var(--text-3)" fontFamily="DM Mono,monospace">{yr}</text>
        ))}
        {series.map(s=>{
          const d=`M ${xp(0)} ${yp(s.pts[0])} `+s.pts.slice(1).map((v,i)=>`L ${xp(i+1)} ${yp(v)}`).join(' ')+` L ${xp(years)} ${yp(0)} L ${xp(0)} ${yp(0)} Z`;
          return <path key={s.ticker} d={d} fill={`url(#g-${s.ticker})`}/>;
        })}
        {series.map(s=>{
          const d=`M ${xp(0)} ${yp(s.pts[0])} `+s.pts.slice(1).map((v,i)=>`L ${xp(i+1)} ${yp(v)}`).join(' ');
          const h=hovered===s.ticker,f=hovered&&!h;
          return <path key={s.ticker} d={d} fill="none" stroke={s.color}
            strokeWidth={h?3.5:f?0.5:1.8} strokeOpacity={f?0.12:1}
            style={{transition:'stroke-width 0.2s,stroke-opacity 0.2s'}}/>;
        })}
        {tip&&<line x1={tip.x} y1={PT} x2={tip.x} y2={PT+ch} stroke="var(--text-3)" strokeWidth="1" strokeDasharray="4 3" strokeOpacity="0.5"/>}
      </svg>

      {tip&&(
        <div style={{background:'var(--tt-bg)',border:'1px solid var(--tt-border)',borderRadius:12,
          padding:'10px 14px',backdropFilter:'blur(16px)',WebkitBackdropFilter:'blur(16px)',
          boxShadow:'0 8px 24px rgba(0,0,0,0.15)',fontSize:12,display:'inline-block',marginTop:8,minWidth:180}}>
          <p style={{fontWeight:700,color:'var(--text-2)',marginBottom:6}}>Year {tip.yr}</p>
          {series.map(s=>(
            <div key={s.ticker} style={{display:'flex',justifyContent:'space-between',gap:16,marginBottom:3}}>
              <span style={{display:'flex',alignItems:'center',gap:5}}>
                <span style={{width:8,height:8,borderRadius:'50%',background:s.color,display:'inline-block'}}/>
                <span style={{fontWeight:600,color:'var(--text-1)'}}>{s.ticker}</span>
              </span>
              <span className="mono" style={{color:'#f43f5e',fontWeight:600}}>{fmt(s.pts[tip.yr]||0)}</span>
            </div>
          ))}
        </div>
      )}

      <div style={{display:'flex',flexWrap:'wrap',gap:'10px 18px',marginTop:tip?8:14,paddingLeft:4}}>
        {series.map(s=>(
          <div key={s.ticker} style={{display:'flex',alignItems:'center',gap:6,cursor:'default',
            opacity:hovered&&hovered!==s.ticker?0.2:1,transition:'opacity 0.2s'}}
            onMouseEnter={()=>setHovered(s.ticker)} onMouseLeave={()=>setHovered(null)}>
            <div style={{width:10,height:10,borderRadius:'50%',background:s.color}}/>
            <span style={{fontSize:11,fontWeight:700,color:'var(--text-1)'}}>{s.ticker}</span>
            <span style={{fontSize:10,color:'var(--text-3)'}}>({(s.ocf*100).toFixed(2)}%)</span>
          </div>
        ))}
      </div>
    </div>
  );
}

function ScoreRow({icon,label,val}) {
  return(
    <div style={{display:'flex',alignItems:'center',marginBottom:8}}>
      <div style={{display:'flex',alignItems:'center',gap:4,width:70,fontSize:9,fontWeight:700,
        color:'var(--text-2)',textTransform:'uppercase',letterSpacing:'0.06em'}}>
        <Icon d={I[icon]} size={10}/> {label}
      </div>
      <div style={{flex:1,height:4,background:'var(--score-bg)',borderRadius:999,overflow:'hidden',
        marginLeft:8,border:'1px solid var(--score-border)'}}>
        <div style={{width:`${val*10}%`,height:'100%',background:'var(--score-bar)',borderRadius:999}}/>
      </div>
      <span className="mono" style={{fontSize:10,fontWeight:700,color:'var(--text-1)',width:24,textAlign:'right',marginLeft:8}}>{val}</span>
    </div>
  );
}

function FundCard({result,hovered,setHovered}) {
  const h=hovered===result.ticker;
  return(
    <div className={`glass glass-card${h?' is-hovered':''}`}
      style={{padding:20,display:'flex',flexDirection:'column'}}
      onMouseEnter={()=>setHovered(result.ticker)}
      onMouseLeave={()=>setHovered(null)}>
      <div style={{display:'flex',justifyContent:'space-between',alignItems:'flex-start',marginBottom:14}}>
        <div style={{display:'flex',gap:8,maxWidth:'70%'}}>
          <div style={{width:4,borderRadius:999,background:result.color,flexShrink:0,alignSelf:'stretch'}}/>
          <div>
            <h4 style={{fontWeight:700,fontSize:13,color:'var(--text-1)',lineHeight:1.3,marginBottom:2}}>{result.name}</h4>
            <p className="mono" style={{fontSize:10,fontWeight:700,color:'var(--text-3)',textTransform:'uppercase',letterSpacing:'0.1em'}}>{result.ticker} Â· {result.type}</p>
          </div>
        </div>
        <div style={{fontSize:10,fontWeight:700,color:'var(--badge)',background:'var(--badge-bg)',padding:'3px 8px',borderRadius:999,whiteSpace:'nowrap'}}>
          {result.coverage}% cov
        </div>
      </div>

      <div style={{marginBottom:14}}>
        <p style={{fontSize:10,color:'var(--text-3)',fontWeight:700,textTransform:'uppercase',letterSpacing:'0.08em',marginBottom:4}}>Fee Drag</p>
        <p className="mono" style={{fontSize:22,fontWeight:700,color:'#f43f5e',lineHeight:1.1}}>{fmt(result.totalFees)}</p>
        <p style={{fontSize:10,color:'var(--text-3)',marginTop:3}}>{result.percentageLost}% of gross growth lost</p>
      </div>

      <div style={{background:'var(--score-bg)',padding:12,borderRadius:12,border:'1px solid var(--score-border)',flex:1}}>
        <div style={{display:'flex',alignItems:'center',gap:4,marginBottom:10,paddingBottom:8,borderBottom:'1px solid var(--divider)'}}>
          <Icon d={I.star} size={12} color="#f59e0b"/>
          <span style={{fontSize:9,fontWeight:800,textTransform:'uppercase',letterSpacing:'0.12em',color:'var(--text-2)'}}>Score Summary</span>
        </div>
        <ScoreRow icon="globe"  label="Coverage" val={result.scores.coverage}/>
        <ScoreRow icon="zap"    label="Low Fees"  val={result.scores.ocf}/>
        <ScoreRow icon="target" label="Precision" val={result.scores.error}/>
        <div style={{marginTop:10,paddingTop:10,borderTop:'1px solid var(--fs-border)',
          background:'var(--fs-bg)',margin:'10px -12px -12px',padding:'10px 12px 12px',borderRadius:'0 0 12px 12px'}}>
          <div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:6}}>
            <div style={{display:'flex',alignItems:'center',gap:4,fontSize:9,fontWeight:800,color:'#10b981',textTransform:'uppercase',letterSpacing:'0.1em'}}>
              <Icon d={I.check} size={12} color="#10b981"/> Final Score
            </div>
            <span className="mono" style={{fontSize:12,fontWeight:800,color:'#10b981'}}>{result.totalScore} / 30</span>
          </div>
          <div style={{height:6,background:'rgba(16,185,129,0.15)',borderRadius:999,overflow:'hidden'}}>
            <div style={{width:`${(result.totalScore/30)*100}%`,height:'100%',background:'#10b981',borderRadius:999,boxShadow:'0 0 6px rgba(16,185,129,0.5)'}}/>
          </div>
        </div>
      </div>

      <div style={{marginTop:14,paddingTop:12,borderTop:'1px solid var(--divider)',display:'flex',justifyContent:'space-between',alignItems:'flex-end'}}>
        <div>
          <p style={{fontSize:10,color:'var(--text-3)',fontWeight:700,textTransform:'uppercase',letterSpacing:'0.08em'}}>Final Balance</p>
          <p className="mono" style={{fontSize:16,fontWeight:700,color:'var(--text-1)'}}>{fmt(result.finalBalance)}</p>
        </div>
        <div style={{textAlign:'right'}}>
          <p style={{fontSize:9,color:'var(--text-3)',fontWeight:700,textTransform:'uppercase',letterSpacing:'0.08em'}}>OCF p.a.</p>
          <p className="mono" style={{fontSize:11,fontWeight:700,color:'var(--text-2)'}}>{(result.ocf*100).toFixed(2)}%</p>
        </div>
      </div>
    </div>
  );
}

function Slider({iconKey,label,value,display,min,max,step,onChange,green}) {
  const pct=((value-min)/(max-min)*100).toFixed(1);
  const track=green
    ?`linear-gradient(to right,#10b981 ${pct}%,var(--track-g) ${pct}%)`
    :`linear-gradient(to right,#3b82f6 ${pct}%,var(--track) ${pct}%)`;
  return(
    <label style={{display:'block'}}>
      <div style={{display:'flex',justifyContent:'space-between',marginBottom:8,alignItems:'center'}}>
        <span style={{display:'flex',alignItems:'center',gap:5,fontSize:11,fontWeight:700,
          color:green?'#10b981':'var(--text-2)',textTransform:'uppercase',letterSpacing:'0.08em'}}>
          <Icon d={I[iconKey]} size={13} color={green?'#10b981':'var(--text-3)'}/> {label}
        </span>
        <span className="mono" style={{fontSize:13,fontWeight:700,color:green?'#10b981':'#3b82f6'}}>{display}</span>
      </div>
      <input type="range" min={min} max={max} step={step} value={value}
        onChange={e=>onChange(Number(e.target.value))} style={{background:track}}/>
    </label>
  );
}

function App() {
  const [investment,setInvestment]=useState(100000);
  const [years,setYears]=useState(25);
  const [growth,setGrowth]=useState(7);
  const [minScore,setMinScore]=useState(0);
  const [hovered,setHovered]=useState(null);
  const [dark,setDark]=useState(()=>window.matchMedia('(prefers-color-scheme: dark)').matches);

  useEffect(()=>{
    document.documentElement.classList.toggle('dark',dark);
  },[dark]);

  useEffect(()=>{
    const mq=window.matchMedia('(prefers-color-scheme: dark)');
    const fn=e=>setDark(e.matches);
    mq.addEventListener('change',fn);
    return()=>mq.removeEventListener('change',fn);
  },[]);

  const {series,maxFee,results,visible}=useCalc(investment,years,growth,minScore);

  return(
    <div style={{minHeight:'100vh',padding:'32px 20px'}}>
      <div style={{maxWidth:1300,margin:'0 auto'}}>

        <header style={{marginBottom:32}}>
          <div style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:4,flexWrap:'wrap',gap:12}}>
            <h1 style={{fontSize:28,fontWeight:800,color:'var(--text-1)',letterSpacing:'-0.02em'}}>
              Global Passive Analysis: 2026 Edition
            </h1>
            <button className="theme-btn" onClick={()=>setDark(d=>!d)}>
              <Icon d={dark?I.sun:I.moon} size={14} color="var(--text-2)"/>
              {dark?'Light mode':'Dark mode'}
            </button>
          </div>
          <p style={{color:'var(--text-3)',fontSize:13,marginBottom:16}}>
            Evaluating Global Equity Coverage vs. Compounded OCF Fees
          </p>
          <div style={{background:'var(--info-bg)',border:'1px solid var(--info-border)',
            backdropFilter:'blur(12px)',WebkitBackdropFilter:'blur(12px)',
            borderRadius:12,padding:'12px 16px',maxWidth:800,display:'flex',gap:12,alignItems:'flex-start'}}>
            <span style={{fontSize:16,lineHeight:'1.6',flexShrink:0}}>ðŸ’¡</span>
            <p style={{fontSize:13,color:'var(--info-text)',lineHeight:1.65}}>
              Set your <strong>investment</strong>, <strong>time horizon</strong>, and <strong>expected growth rate</strong> on the left â€” the chart and cards update instantly. The chart shows how much each fund's annual fee eats into your returns over time. Use the <strong>Min Score filter</strong> to strip out lower-rated funds and focus on the best.
            </p>
          </div>
        </header>

        <div className="main-grid" style={{display:'grid',gridTemplateColumns:'270px 1fr',gap:24,alignItems:'start'}}>

          <div className="glass" style={{padding:24}}>
            <h3 style={{fontSize:11,fontWeight:800,color:'var(--text-3)',textTransform:'uppercase',
              letterSpacing:'0.15em',textAlign:'center',marginBottom:24}}>Parameters</h3>
            <div style={{display:'flex',flexDirection:'column',gap:26}}>
              <Slider iconKey="pound"    label="Investment" value={investment} display={fmt(investment)}    min={1000}  max={2000000} step={5000} onChange={setInvestment}/>
              <Slider iconKey="calendar" label="Years"      value={years}      display={`${years} yrs`}    min={1}     max={50}      step={1}    onChange={setYears}/>
              <Slider iconKey="trend"    label="Growth"     value={growth}     display={`${growth}% p.a.`} min={0}     max={15}      step={0.5}  onChange={setGrowth}/>
              <div style={{paddingTop:20,borderTop:'1px solid var(--divider)'}}>
                <Slider iconKey="filter" label="Min Score" value={minScore} display={`${minScore} / 30`} min={0} max={30} step={1} onChange={setMinScore} green/>
                <p style={{fontSize:10,color:'var(--text-3)',marginTop:8,fontStyle:'italic',textAlign:'center',lineHeight:1.5}}>
                  Hides funds below this combined score from the analysis.
                </p>
              </div>
            </div>
          </div>

          <div style={{display:'flex',flexDirection:'column',gap:24}}>
            <div className="glass" style={{padding:24}}>
              <div style={{display:'flex',justifyContent:'space-between',alignItems:'flex-start',marginBottom:20}}>
                <div>
                  <h3 style={{fontSize:16,fontWeight:700,display:'flex',alignItems:'center',gap:8,color:'var(--text-1)'}}>
                    <Icon d={I.bar} size={18} color="#f43f5e"/> The Cost of Fees
                  </h3>
                  <p style={{fontSize:11,color:'var(--text-3)',marginTop:4}}>
                    {visible.length>0
                      ?`Compounded OCF drag over ${years} years for ${visible.length} qualifying fund${visible.length!==1?'s':''}.`
                      :'No funds match the current score filter.'}
                  </p>
                </div>
                <div style={{padding:'4px 12px',background:'var(--badge-bg)',color:'var(--badge)',
                  borderRadius:999,fontSize:10,fontWeight:700,textTransform:'uppercase',whiteSpace:'nowrap'}}>
                  {visible.length} Active
                </div>
              </div>
              <Chart series={series} years={years} maxFee={maxFee} hovered={hovered} setHovered={setHovered}/>
            </div>

            <div style={{display:'grid',gridTemplateColumns:'repeat(auto-fill,minmax(230px,1fr))',gap:16}}>
              {results.map(r=>(
                <FundCard key={r.ticker} result={r} hovered={hovered} setHovered={setHovered}/>
              ))}
              {results.length===0&&(
                <div style={{gridColumn:'1/-1',textAlign:'center',padding:'40px 0',color:'var(--text-3)'}}>
                  <Icon d={I.filter} size={32}/>
                  <p style={{marginTop:10,fontWeight:500}}>No funds match the current filter.</p>
                </div>
              )}
            </div>
          </div>

        </div>
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
</script>
</body>
</html>
